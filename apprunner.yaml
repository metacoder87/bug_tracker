version: 1.0
runtime: ruby31 
build:
  commands:
    pre-build:
      - rbenv install 3.1.0
      - gem install bundler -v 2.4.7
      - sudo yum install postgresql postgresql-server postgresql-devel postgresql-contrib postgresql-docs
      - sudo service postgresql initdb
    build:
      - bundle install
      - rails db:create
      - rails db:migrate
      - RAILS_ENV=production rake assets:precompile
run:
  command: bundle exec rackup --host 0.0.0.0 -p 8080
